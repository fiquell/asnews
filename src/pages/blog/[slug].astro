---
import type { Article } from "@interfaces/newsapi"
import Layout from "@layouts/Layout.astro"
import newsapi from "@lib/newsapi"

export const getStaticPaths = async () => {
  const articles = await newsapi<Article[]>({
    endpoint: "top-headlines",
    country: "us",
    category: "general",
    wrappedByKey: "articles"
  })

  return articles.map((article) => ({
    params: { slug: article.publishedAt },
    props: article
  }))
}

type Props = Article

const article = Astro.props
---

<Layout>
  <section class="flex flex-col mt-10">
    <img
      src={article.urlToImage}
      alt={article.title}
      class="rounded-md w-full h-96 object-cover"
    />
    <p class="text-3xl font-bold my-5">{article.title}</p>
    <p>{article.description}</p>
    <a href={article.url} target="_blank" class="hover:underline mt-3">
      Read more!
    </a>
  </section>
</Layout>
